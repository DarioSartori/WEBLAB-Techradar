<div class="toolbar">
  <button (click)="filter = 'all'; load()">All</button>
  <button (click)="filter = 'draft'; load()">Drafts</button>
  <button (click)="filter = 'published'; load()">Published</button>
  <button class="primary" (click)="new()">New</button>
</div>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Category</th>
      <th>Ring</th>
      <th>State</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let t of list">
      <td>{{ t.name }}</td>
      <td>{{ t.category }}</td>
      <td>{{ t.ring || "â€”" }}</td>
      <td>
        <span
          class="badge"
          [class.draft]="!t.publishedAt"
          [class.published]="t.publishedAt"
        >
          {{ t.publishedAt ? "Published" : "Draft" }}
        </span>
      </td>
      <td>
        <button (click)="edit(t)">Edit</button>
        <button *ngIf="!t.publishedAt" (click)="openPublish(t)">
          Publish
        </button>
      </td>
    </tr>
  </tbody>
</table>

<div *ngIf="publishing" class="dialog" (click)="publishing=null">
  <div class="panel" (click)="$event.stopPropagation()">
    <h3>Publish: {{ publishing?.name }}</h3>

    <label>Ring</label>
    <select [(ngModel)]="pub.ring">
      <option [ngValue]="''">Please Choose</option>
      <option *ngFor="let r of rings" [ngValue]="r">{{ r }}</option>
    </select>

    <label>Description</label>
    <textarea [(ngModel)]="pub.ringDescription"></textarea>

    <div class="actions">
      <button (click)="doPublish()" [disabled]="!pub.ring || !pub.ringDescription">Publish</button>
      <button (click)="publishing=null">Cancle</button>
    </div>
  </div>
</div>
